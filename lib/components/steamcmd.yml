name: InstallSteamCMD
description: Installs SteamCMD on Amazon Linux 2023
schemaVersion: 1.0

phases:
  - name: build
    steps:
      - name: InstallDependencies
        action: ExecuteBash
        inputs:
          commands:
            - sudo add-apt-repository multiverse
            - sudo dpkg --add-architecture i386
            - sudo apt update -y

      - name: InsertSteamPromptAnswers
        action: ExecuteBash
        inputs:
          commands:
            - echo steam steam/question select "I AGREE" | debconf-set-selections && echo steam steam/license note '' | debconf-set-selections

      - name: InstallSteamCMD
        action: ExecuteBash
        inputs:
          commands:
            - sudo apt install -y lib32gcc1 ca-certificates locales steamcmd

      - name: CreateSymLinks
        action: ExecuteBash
        inputs:
          commands:
            - sudo ln -s /usr/games/steamcmd /usr/bin/steamcmd

      - name: UpdateSteamCMD
        action: ExecuteBash
        inputs:
          commands:
            - steamcmd +quit
